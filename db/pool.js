// db/pool.js

// -------------------------------------------------------------
// MySQL への接続を作るためのライブラリ mysql2/promise を読み込む
// （promise版を使うことで async/await が使えるようになる）
// -------------------------------------------------------------
const mysql = require("mysql2/promise");

// -------------------------------------------------------------
// DB接続設定を読み込む
// ../config/db.js に host / user / password / database が書いてある
// -------------------------------------------------------------
const config = require("../config/db");

// -------------------------------------------------------------
// createPool() は「コネクションプール」を作成する関数
//
// ✔ コネクションプールとは？
//     - DB との接続を複数まとめて作っておき、使い回す仕組み
//     - リクエストのたびに DB 接続を新規作成するのはコストが高い
//     - だから pool を作っておくと高速 & 安定
//
// ✔ pool.query(...) がすぐ使えるようになる
// -------------------------------------------------------------
const pool = mysql.createPool(config);

// -------------------------------------------------------------
// 他のファイルから `require("./db/pool")` で
// この pool にアクセスできるようにする
// -------------------------------------------------------------
module.exports = pool;